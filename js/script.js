"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("form");function t(e){e.parentElement.classList.add("_error"),e.classList.add("_error")}function n(e){e.parentElement.classList.remove("_error"),e.classList.remove("_error")}function s(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(value)}e.addEventListener("submit",(async function(a){a.preventDefault();let r=function(e){let i=0,l=document.querySelectorAll("._req");for(let e=0;e<l.length;e++){const a=l[e];n(a),a.classList.contains("._email")?s(a)&&(t(a),i++):("checkbox"===a.getAttribute("type")&&!1===a.checked||""===a.value)&&(t(a),i++)}return i}(),o=new FormData(e);if(o.append("image",i.files[0]),0===r){e.classList.add("_sending");let t=await fetch("sendmail.php",{method:"POST",body:o});if(t.ok){let n=await t.json();alert(n.message),l.innerHTML="",e.reset(),e.classList.remove("_sending")}else alert("Ошибка"),e.classList.remove("_sending")}else alert("Заполните обязательные поля")}));const i=document.getElementById("formImage"),l=document.getElementById("formPreview");i.addEventListener("change",(()=>{!function(e){if(!["image/jpeg","image/png","image/gif"].includes(e.type))return alert("Разрешены только изображения"),void(i.value="");if(e.size>2097152)return void alert("Файл должен быть менее 2мб");var t=new FileReader;t.onload=function(e){l.innerHTML=`<img src="${e.target.result}" alt="Фото">`},t.onerror=function(e){alert("Ошибка")},t.readAsDataURL(e)}(i.files[0])}))})),$(".select").each((function(){const e=$(this),t=e.find("option"),n=t.length;t.filter(":selected");e.hide(),e.wrap('<div class="select"></div>'),$("<div>",{class:"new-select",text:e.children("option:disabled").text()}).insertAfter(e);const s=e.next(".new-select");$("<div>",{class:"new-select__list"}).insertAfter(s);const i=s.next(".new-select__list");for(let e=1;e<n;e++)$("<div>",{class:"new-select__item",html:$("<span>",{text:t.eq(e).text()})}).attr("data-value",t.eq(e).val()).appendTo(i);const l=i.find(".new-select__item");i.slideUp(0),s.on("click",(function(){$(this).hasClass("on")?($(this).removeClass("on"),i.slideUp(450)):($(this).addClass("on"),i.slideDown(450),l.on("click",(function(){let e=$(this).data("value");$("select").val(e).attr("selected","selected"),s.text($(this).find("span").text()),i.slideUp(450),s.removeClass("on")})))}))}));